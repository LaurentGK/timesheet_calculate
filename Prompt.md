# 工时计算器开发需求

## 项目概述
开发一个 Web 应用，用于计算员工月度白班/夜班工时，基于打卡 Excel 表格自动统计。

## 核心功能需求

### 1. 前端界面
- 文件上传组件：支持拖拽上传 `.xlsx` 格式的考勤表
- 表格预览区：上传后显示原始数据预览（日期、上班、下班时间）
- 计算结果展示区：展示每日明细 + 月度汇总统计
- 导出功能：可下载计算结果报表

### 2. 数据解析规则
**Excel 格式说明：**
- `template-timesheet.xlsx` 为模板表格，供你理解使用
- 第1行为标题行（"日期"、"上班时间"、"下班时间"）
- 第2行起为数据行

### 3. 工时计算逻辑（核心算法）
**白班工时定义：** 19:00 之前的工作时间，截止至 19:00
**夜班工时定义：** 19:00 之后的工作时间（含跨天情况）

**计算规则：**
```
场景 A：上下班都在 19:00 前
- 白班工时 = 下班时间 - 上班时间
- 夜班工时 = 0

场景 B：上班在 19:00 前，下班在 19:00 后（跨时段）
- 白班工时 = 19:00 - 上班时间
- 夜班工时 = 下班时间 - 19:00

场景 C：上下班都在 19:00 后（纯夜班）
- 白班工时 = 0
- 夜班工时 = 下班时间 - 上班时间

场景 D：跨天班次（下班时间 < 上班时间）
- 假设下班时间为次日，需加 1.0（24小时）计算实际时长
- 白班部分：仅计算当天 19:00 前的部分
- 夜班部分：19:00 至次日下班时间的全部时长
```

**时间转换基准：**
- Excel 时间 0.791666667 = 19:00（19/24 = 0.791666...）
- 分钟转小时：除以 24 或 乘以 24 转换

### 4. 输出要求
**每日明细：**
| 日期 | 上班时间 | 下班时间 | 白班工时 | 夜班工时 | 总工时 |
|------|----------|----------|----------|----------|--------|

**月度汇总：**
- 总白班工时：XX 小时 XX 分钟
- 总夜班工时：XX 小时 XX 分钟
- 当月总工时：XX 小时 XX 分钟
- 工作天数：X 天

## 技术栈建议
- 前端：HTML + JavaScript（或 React/Vue）
- 后端：Python + Flask/FastAPI
- Excel 处理：pandas 或 openpyxl
- 时间计算：datetime 模块

## 附件说明
- `template-timesheet.xlsx`：示例数据文件，包含 1 月打卡记录
- 时间格式：Excel 原生小数时间值
- 数据范围：约 30 天记录

## 特殊注意
- 需处理 Excel 日期序列号转换（从 1899-12-30 起算的天数）
- 需处理跨天班次（夜班常见次日下班）
- 边界情况：正好 19:00 打卡算白班还是夜班？应归入夜班